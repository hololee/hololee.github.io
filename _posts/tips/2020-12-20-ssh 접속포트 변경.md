---
title: ssh 접속포트 변경
date: 2020-12-20 19:30:00 +0900
categories: [tips]
tags: [ssh, ubuntu, os]     # TAG names should always be lowercase
img_path: /
---
최근에 근처 연구실에서 랜섬웨어에 감염되었다는 소식을 들어서 최소한의 해킹은 방지하기 위해서 포트 번호를 변경하였다.  

우분투에서 SSH 포트 변경은 포트 변경 설정 파일을 수정해주고 방화벽을 통해서 22번은 차단, 열고자 하는 번호를 열어주면 된다 (여기서는 22222 로 가정하고 진행한다.).

**현재 열려있는 세션은 끄기 전까지 적용되지 않으니 새로 세션을 열어 확인하기 전까지 유지해야 한다!**

~~~bash
// ssh 접속 포트 변경. 
$ sudo gedit /etc/ssh/sshd_config
~~~



편의상 gedit 으로 편하게 진행하였다. 

위에 파일을 열어보면`Port=22`로 되어있는데(주석 처리시 주석 해제) `Port=22222`로 변경한다.  



그 다음 아래처럼 방화벽 상태를 확인한다.

~~~bash
// 방화벽 상태 확인 
$ sudo ufw status verbose
~~~



다음으로 22번 포트는 닫고 22222 포트를 열어준다.

~~~bash
// 포트 열기. 
$ sudo ufw allow 22222

// 포트 닫기.  
$ sudo ufw deny 22
~~~



실수로 잘못된 포트를 입력 하였다면 아래처럼 지워준다.

~~~bash
// 규칙 지우기. 
$ sudo ufw delete allow <잘못쓴 번호>
~~~



마지막으로 ssh 서비스를 재시작한다.

~~~bash
//ssh 재시작. 
$ service ssh restart
~~~



포트가 잘 동작하는지 확인 해본다.

~~~bash
// 열린 포트 확인. 
$ sudo netstat -anp | grep LISTEN | grep sshd
~~~



**※ 전부 확인이 되었으면 새로운 새션을 열어서 22, 22222 포트 모두 확인!!**


p.s 내무망에서 특정 포트의 연결을 막아둔것 같아서 내부 망에서만 접속이 되었다... 다시 22번 포트를 열어서 해결..  포트를 여러개 열려면 아래처럼 여러번 입력하면 된다.

~~~bash
Port 22 Port 22222
~~~



> 네이버에서 이전한 포스트로 오래전 작성되어서 내용이 잘못되었을 수 있습니다. 오류나 잘못된 정보 전달시 댓글로 알려주세요!
{: .prompt-info }